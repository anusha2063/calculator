<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Modern Calculator</title>
    <link rel="stylesheet" href="style.css"> 
    <link rel="icon" href="favicon.jpg">
</head>
<body>
    <div class="calculator-container">
        <div class="calculator">
            <div class="calculator-header">
                <h1>Calculator</h1>
            </div>
            
            <div class="display-container">
                <form name="form1">
                    <input class="display" name="textview" readonly>
                </form>
            </div>
            
            <div class="buttons-container">
                <button class="btn btn-clear" onclick="clearAll()">
                    C
                </button>
                <button class="btn btn-backspace" onclick="backspace()">
                    ⌫
                </button>
                <button class="btn btn-operator" onclick="insert('/')">÷</button>
                <button class="btn btn-operator" onclick="insert('*')">×</button>
                
                <button class="btn btn-number" onclick="insert('7')">7</button>
                <button class="btn btn-number" onclick="insert('8')">8</button>
                <button class="btn btn-number" onclick="insert('9')">9</button>
                <button class="btn btn-operator" onclick="insert('-')">−</button>
                
                <button class="btn btn-number" onclick="insert('4')">4</button>
                <button class="btn btn-number" onclick="insert('5')">5</button>
                <button class="btn btn-number" onclick="insert('6')">6</button>
                <button class="btn btn-operator" onclick="insert('+')">+</button>
                
                <button class="btn btn-number" onclick="insert('1')">1</button>
                <button class="btn btn-number" onclick="insert('2')">2</button>
                <button class="btn btn-number" onclick="insert('3')">3</button>
                <button class="btn btn-equals" onclick="equal()">=</button>
                
                <button class="btn btn-number btn-zero" onclick="insert('0')">0</button>
                <button class="btn btn-number" onclick="insert('.')">.</button>
            </div>
        </div>
    </div>

    <script>
        // Calculator state
        let currentInput = '';
        let operator = '';
        let previousInput = '';
        let shouldResetDisplay = false;

        function updateDisplay(value = currentInput) {
            document.form1.textview.value = value;
        }

        function insert(value) {
            if (shouldResetDisplay) {
                currentInput = '';
                shouldResetDisplay = false;
            }
            
            // Prevent multiple decimal points
            if (value === '.' && currentInput.includes('.')) {
                return;
            }
            
            // Prevent multiple operators
            if (['+', '-', '*', '/'].includes(value)) {
                if (currentInput === '' && previousInput === '') {
                    return;
                }
                
                if (operator && currentInput && previousInput) {
                    calculate();
                }
                
                operator = value;
                previousInput = currentInput || previousInput;
                currentInput = '';
                updateDisplay(previousInput + ' ' + getOperatorSymbol(operator) + ' ');
                return;
            }
            
            currentInput += value;
            updateDisplay(currentInput);
        }

        function getOperatorSymbol(op) {
            switch(op) {
                case '+': return '+';
                case '-': return '−';
                case '*': return '×';
                case '/': return '÷';
                default: return op;
            }
        }

        function calculate() {
            if (!operator || previousInput === '' || currentInput === '') {
                return;
            }
            
            let prev = parseFloat(previousInput);
            let current = parseFloat(currentInput);
            let result;
            
            switch(operator) {
                case '+':
                    result = prev + current;
                    break;
                case '-':
                    result = prev - current;
                    break;
                case '*':
                    result = prev * current;
                    break;
                case '/':
                    if (current === 0) {
                        updateDisplay('Error: Division by zero');
                        reset();
                        return;
                    }
                    result = prev / current;
                    break;
                default:
                    return;
            }
            
            // Round to avoid floating point errors
            result = Math.round(result * 100000000) / 100000000;
            
            currentInput = result.toString();
            operator = '';
            previousInput = '';
            shouldResetDisplay = true;
            updateDisplay(currentInput);
        }

        function equal() {
            calculate();
        }

        function backspace() {
            if (shouldResetDisplay) {
                return;
            }
            
            currentInput = currentInput.slice(0, -1);
            updateDisplay(currentInput || '0');
        }

        function clearAll() {
            reset();
            updateDisplay('0');
        }

        function reset() {
            currentInput = '';
            operator = '';
            previousInput = '';
            shouldResetDisplay = false;
        }

        // Initialize display
        updateDisplay('0');

        // Add keyboard support
        document.addEventListener('keydown', function(event) {
            const key = event.key;
            
            if(key >= '0' && key <= '9') {
                insert(key);
            } else if(key === '+' || key === '-') {
                insert(key);
            } else if(key === '*') {
                insert('*');
            } else if(key === '/') {
                event.preventDefault();
                insert('/');
            } else if(key === '.') {
                insert('.');
            } else if(key === 'Enter' || key === '=') {
                event.preventDefault();
                equal();
            } else if(key === 'Backspace') {
                event.preventDefault();
                backspace();
            } else if(key === 'Escape' || key.toLowerCase() === 'c') {
                clearAll();
            }
        });
    </script>
</body>
</html>